{% extends "base.jinja2" %}

{% block stylesheet %}
    {{ super() }}
{% endblock %}

{% block content %}

<h1 class="text-center mb-3 home-h1">Wonderfull Moments</h1>
<div class="row">
{% for photo in photos %}
        <div class="col-4">
            <div class="card" style="height: 28rem; width: 22rem;">
                <img class="card-img-top" height="254" width="200" src="{{ request.static_url('wedding_gallery:images/' + photo.uuid )}}" alt="{{photo.name}}" 
                     data-toggle="modal" data-target="#exampleModalCenter" data-whatever="{{ request.static_url('wedding_gallery:images/' + photo.uuid )}}">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <button type="button" class="btn btn-default btn-sm like" id="{{photo.id}}">
                            {% if request.user.id in photo.likes|map(attribute='user_id') %}
                                <i class="fas fa-heart"></i>
                            {% else %}
                                <i class="far fa-heart"></i>
                            {%endif%}
                        </button>
                        <strong id="like{{photo.id}}">{{photo.likes|length}} like(s)</strong>
                    </li>
                </ul>
                <div class="card-body">
                    <p class="card-text">{{ photo.description }}</p> 
                </div>
                <div class="card-footer">
                    <p class="card-text"><small class="text-muted">uploaded in: {{photo.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</small></p>
                </div>
            </div>
        </div>
{% endfor %}
</div>  
{% set url='$page' %}
<div class="pager">
    {% set link_attr={"class": "btn small"} %}
    {% set curpage_attr={"class": "btn primary small disabled"} %}
    {% set dotdot_attr={"class": "btn small disabled"} %}
    <!-- Usei o filter com parametro striotags para converter as strings de retorno
    para tags html-->
    {% filter striptags %}
        {{ photos.pager(url=url,format="$link_previous ~2~ $link_next",
                                                  symbol_previous="«", symbol_next="»",
                                                 link_attr=link_attr, curpage_attr=curpage_attr,
                                                 dotdot_attr=dotdot_attr)}}
    {% endfilter %}
</div>

<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
        <div class="modal-body" style="padding: 0">
             <img class="card-img" height="440" width="400" src="" alt="imagem">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
    </div>
  </div>
</div>
{% endblock content %}

{% block javascript %}
    {{ super() }}
    <script src="{{request.static_url('wedding_gallery:static/js/home.js')}}"></script>
{% endblock javascript %}